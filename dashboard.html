<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üíé ProfitPal Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #1e3a5f 50%, #2c5f2d 100%);
            min-height: 100vh;
            color: #ffffff;
            overflow-x: hidden;
        }

        /* Animated background */
        .background-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .floating-shape {
            position: absolute;
            background: linear-gradient(135deg, rgba(50, 205, 50, 0.1), rgba(255, 215, 0, 0.05));
            border-radius: 50%;
            animation: float 20s infinite ease-in-out;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(100px, -100px) rotate(90deg); }
            50% { transform: translate(-50px, -200px) rotate(180deg); }
            75% { transform: translate(-150px, -50px) rotate(270deg); }
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, rgba(15, 35, 65, 0.9), rgba(30, 58, 95, 0.8));
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(34, 139, 34, 0.3);
            padding: 0 30px;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px;
        }

        .logo {
            font-size: 24px;
            font-weight: 900;
            background: linear-gradient(135deg, #32cd32, #ffd700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #32cd32, #228b22);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 16px;
        }

        .nav-menu {
            display: flex;
            gap: 30px;
            align-items: center;
        }

        .nav-item {
            color: #ecf0f1;
            text-decoration: none;
            font-weight: 500;
            padding: 10px 15px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .nav-item:hover, .nav-item.active {
            background: rgba(50, 205, 50, 0.1);
            color: #32cd32;
        }

        /* Main Container */
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px;
            z-index: 10;
            position: relative;
        }

        /* üî• REFERRAL BANNER - –ì–õ–ê–í–ù–ê–Ø –§–ò–ß–ê! */
        .referral-banner {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(50, 205, 50, 0.15));
            backdrop-filter: blur(20px);
            border: 3px solid rgba(255, 215, 0, 0.6);
            border-radius: 20px;
            padding: 25px 35px;
            margin-bottom: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .referral-banner:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(255, 215, 0, 0.3);
            border-color: #ffd700;
        }

        .referral-banner::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.2), transparent);
            transition: left 0.5s;
        }

        .referral-banner:hover::before {
            left: 100%;
        }

        .referral-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            z-index: 2;
        }

        .referral-main {
            flex: 1;
        }

        .referral-title {
            font-size: 20px;
            font-weight: 800;
            color: #ffd700;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .referral-link {
            font-family: 'Courier New', monospace;
            font-size: 16px;
            color: #ffffff;
            background: rgba(0, 0, 0, 0.3);
            padding: 12px 16px;
            border-radius: 10px;
            border: 1px solid rgba(255, 215, 0, 0.3);
            word-break: break-all;
            margin: 10px 0;
            position: relative;
        }

        .copy-hint {
            font-size: 14px;
            color: #87ceeb;
            font-style: italic;
            margin-top: 5px;
        }

        .referral-stats {
            display: flex;
            gap: 30px;
            align-items: center;
        }

        .referral-stat {
            text-align: center;
            padding: 15px;
            background: rgba(50, 205, 50, 0.1);
            border-radius: 12px;
            border: 1px solid rgba(50, 205, 50, 0.3);
            min-width: 120px;
        }

        .stat-number-large {
            font-size: 28px;
            font-weight: 900;
            color: #32cd32;
            display: block;
            line-height: 1;
        }

        .stat-label-small {
            font-size: 12px;
            color: #87ceeb;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 5px;
        }

        .free-months-highlight {
            background: linear-gradient(135deg, #32cd32, #228b22) !important;
            color: white !important;
        }

        .free-months-highlight .stat-number-large {
            color: white !important;
        }

        .free-months-highlight .stat-label-small {
            color: rgba(255, 255, 255, 0.8) !important;
        }

        /* üî• BOOST DEVELOPMENT BANNER */
        .boost-banner {
            background: linear-gradient(135deg, rgba(255, 107, 53, 0.2), rgba(255, 193, 7, 0.15));
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 107, 53, 0.5);
            border-radius: 15px;
            padding: 20px 25px;
            margin-bottom: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .boost-banner:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(255, 107, 53, 0.2);
            border-color: #ff6b35;
        }

        .boost-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .boost-title {
            font-size: 18px;
            font-weight: 800;
            color: #ff6b35;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .boost-subtitle {
            font-size: 14px;
            color: #ffffff;
            font-weight: 400;
        }

        .boost-expand-hint {
            font-size: 14px;
            color: #87ceeb;
            font-style: italic;
        }

        .boost-options {
            background: linear-gradient(135deg, rgba(30, 58, 95, 0.4), rgba(15, 35, 65, 0.6));
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            border: 2px solid rgba(255, 107, 53, 0.3);
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .donation-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .donation-btn {
            background: linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(255, 193, 7, 0.05));
            border: 2px solid rgba(255, 107, 53, 0.3);
            border-radius: 12px;
            padding: 20px 15px;
            color: #ffffff;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .donation-btn:hover {
            background: linear-gradient(135deg, rgba(255, 107, 53, 0.2), rgba(255, 193, 7, 0.1));
            border-color: #ff6b35;
            transform: translateY(-2px);
        }

        .donation-btn .price {
            display: block;
            font-size: 20px;
            color: #ff6b35;
            margin-top: 5px;
        }

        .custom-donation {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(44, 62, 80, 0.3);
            border: 2px solid rgba(255, 107, 53, 0.3);
            border-radius: 12px;
            padding: 20px 15px;
            color: #ffffff;
            font-weight: 600;
            justify-content: center;
        }

        .custom-donation input {
            background: transparent;
            border: none;
            color: #ffffff;
            font-size: 18px;
            font-weight: bold;
            width: 80px;
            text-align: center;
        }

        .custom-donation input:focus {
            outline: none;
        }

        .currency {
            font-size: 20px;
            color: #ff6b35;
        }

        .donation-agreement {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(44, 62, 80, 0.2);
            border-radius: 8px;
        }

        .donation-agreement input[type="checkbox"] {
            transform: scale(1.2);
            accent-color: #ff6b35;
        }

        .donation-submit {
            width: 100%;
            background: linear-gradient(135deg, #ff6b35, #e74c3c);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .donation-submit:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 107, 53, 0.3);
        }

        .donation-submit:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Copy Success Animation */
        .copy-success {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #32cd32, #228b22);
            color: white;
            padding: 20px 30px;
            border-radius: 15px;
            font-size: 18px;
            font-weight: 600;
            z-index: 1000;
            animation: copyFeedback 2s ease-out;
        }

        @keyframes copyFeedback {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            20% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
            80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(1); }
        }

        /* Welcome Section */
        .welcome-section {
            background: linear-gradient(135deg, rgba(30, 58, 95, 0.4), rgba(15, 35, 65, 0.6));
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            border: 2px solid rgba(34, 139, 34, 0.3);
            position: relative;
            overflow: hidden;
        }

        .welcome-content {
            position: relative;
            z-index: 2;
        }

        .welcome-title {
            font-size: 36px;
            font-weight: 900;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #ffffff, #32cd32);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .welcome-subtitle {
            font-size: 18px;
            color: #bdc3c7;
            margin-bottom: 20px;
        }

        .quick-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: rgba(44, 62, 80, 0.3);
            border-radius: 12px;
            border: 1px solid rgba(34, 139, 34, 0.2);
        }

        .stat-number {
            font-size: 24px;
            font-weight: 900;
            color: #32cd32;
            display: block;
        }

        .stat-label {
            font-size: 12px;
            color: #95a5a6;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .dashboard-card {
            background: linear-gradient(135deg, rgba(30, 58, 95, 0.4), rgba(15, 35, 65, 0.6));
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            border: 2px solid rgba(34, 139, 34, 0.3);
            transition: all 0.3s ease;
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(50, 205, 50, 0.1);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 20px;
            font-weight: 700;
            color: #ffffff;
        }

        .card-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #32cd32, #228b22);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        /* Quick Analysis */
        .analysis-input {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .ticker-input {
            flex: 1;
            padding: 15px 20px;
            background: rgba(44, 62, 80, 0.3);
            border: 2px solid rgba(34, 139, 34, 0.2);
            border-radius: 12px;
            color: #ffffff;
            font-size: 16px;
            text-transform: uppercase;
        }

        .ticker-input:focus {
            outline: none;
            border-color: #32cd32;
        }

        .analyze-btn {
            background: linear-gradient(135deg, #32cd32, #228b22);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(50, 205, 50, 0.3);
        }

        /* Portfolio Table */
        .portfolio-table {
            width: 100%;
            border-collapse: collapse;
        }

        .portfolio-table th,
        .portfolio-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(34, 139, 34, 0.2);
        }

        .portfolio-table th {
            color: #32cd32;
            font-weight: 600;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .portfolio-table td {
            color: #ecf0f1;
        }

        .positive { color: #32cd32; }
        .negative { color: #e74c3c; }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .action-btn {
            padding: 12px 20px;
            border: 2px solid rgba(34, 139, 34, 0.3);
            background: rgba(44, 62, 80, 0.3);
            color: #32cd32;
            border-radius: 10px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            text-align: center;
            flex: 1;
        }

        .action-btn:hover {
            background: rgba(50, 205, 50, 0.1);
            border-color: #32cd32;
            transform: translateY(-2px);
        }

        .action-btn.primary {
            background: linear-gradient(135deg, #32cd32, #228b22);
            border-color: #32cd32;
            color: white;
        }

        /* Recommendations */
        .recommendation-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: rgba(44, 62, 80, 0.3);
            border-radius: 10px;
            border-left: 4px solid #32cd32;
        }

        .recommendation-content h4 {
            color: #ffffff;
            margin-bottom: 5px;
        }

        .recommendation-content p {
            color: #95a5a6;
            font-size: 14px;
        }

        .recommendation-badge {
            background: linear-gradient(135deg, #32cd32, #228b22);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        /* üî• REFERRAL FRIENDS LIST */
        .referral-friends {
            background: linear-gradient(135deg, rgba(30, 58, 95, 0.4), rgba(15, 35, 65, 0.6));
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            margin-top: 30px;
            border: 2px solid rgba(34, 139, 34, 0.3);
        }

        .friends-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .next-billing-info {
            color: #32cd32;
            font-weight: 600;
            font-size: 14px;
            padding: 8px 15px;
            background: rgba(50, 205, 50, 0.1);
            border-radius: 20px;
            border: 1px solid rgba(50, 205, 50, 0.3);
        }

        .friend-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            margin-bottom: 8px;
            background: rgba(44, 62, 80, 0.3);
            border-radius: 10px;
            border-left: 4px solid #ffd700;
        }

        .friend-email {
            color: #ffffff;
            font-weight: 500;
        }

        .friend-date {
            color: #95a5a6;
            font-size: 14px;
        }

        .friend-reward {
            background: linear-gradient(135deg, #ffd700, #ffed4a);
            color: #0a0e27;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
        }

        .progress-section {
            text-align: center;
            margin-top: 20px;
            padding: 20px;
            background: rgba(255, 215, 0, 0.1);
            border-radius: 12px;
        }

        .progress-bar-container {
            background: rgba(0,0,0,0.3);
            height: 8px;
            border-radius: 4px;
            margin: 10px 0;
            position: relative;
            overflow: hidden;
        }

        .progress-bar {
            background: linear-gradient(135deg, #32cd32, #228b22);
            height: 100%;
            border-radius: 4px;
            transition: width 1s ease;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .main-container {
                padding: 20px;
            }

            .header-content {
                padding: 0 20px;
            }

            .nav-menu {
                display: none;
            }

            .referral-content {
                flex-direction: column;
                gap: 20px;
            }

            .referral-stats {
                flex-direction: row;
                gap: 15px;
                justify-content: center;
            }

            .referral-stat {
                min-width: 100px;
            }

            .friends-header {
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
            }

            .donation-grid {
                grid-template-columns: 1fr 1fr;
            }

            .boost-content {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
        }
        /* üî• PRO/DOWNGRADE BANNER STYLES */
            .pro-banner, .downgrade-banner {
                background: linear-gradient(135deg, rgba(255, 107, 53, 0.2), rgba(255, 193, 7, 0.15));
                backdrop-filter: blur(20px);
                border: 2px solid rgba(255, 107, 53, 0.5);
                border-radius: 15px;
                padding: 20px 25px;
                margin-bottom: 25px;
                cursor: pointer;
                transition: all 0.3s ease;
                position: relative;
            }

            .downgrade-banner {
                background: linear-gradient(135deg, rgba(135, 206, 235, 0.2), rgba(95, 158, 160, 0.15));
                border-color: rgba(135, 206, 235, 0.5);
            }

            .pro-banner:hover, .downgrade-banner:hover {
                transform: translateY(-2px);
                box-shadow: 0 10px 30px rgba(255, 107, 53, 0.2);
                border-color: #ff6b35;
            }

            .downgrade-banner:hover {
                box-shadow: 0 10px 30px rgba(135, 206, 235, 0.2);
                border-color: #87ceeb;
            }

            .pro-options, .downgrade-options {
                background: linear-gradient(135deg, rgba(30, 58, 95, 0.4), rgba(15, 35, 65, 0.6));
                backdrop-filter: blur(20px);
                border-radius: 15px;
                padding: 25px;
                margin-bottom: 25px;
                border: 2px solid rgba(255, 107, 53, 0.3);
                animation: slideDown 0.3s ease-out;
            }

            .downgrade-options {
                border-color: rgba(135, 206, 235, 0.3);
            }
        </style>
</head>
<body>

    <script src="/pp-auth.js"></script>
    <script>ensureSessionOrRedirect();</script>

    <!-- Background Animation -->
    <div class="background-animation">
        <div class="floating-shape" style="width: 100px; height: 100px; top: 10%; left: 80%; animation-delay: 0s;"></div>
        <div class="floating-shape" style="width: 150px; height: 150px; top: 60%; left: 10%; animation-delay: 5s;"></div>
        <div class="floating-shape" style="width: 80px; height: 80px; top: 30%; left: 60%; animation-delay: 10s;"></div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">üíé ProfitPal</div>

            <nav class="nav-menu">
                <a href="#" class="nav-item active">Dashboard</a>
                <a href="#" class="nav-item">Analysis</a>
                <a href="#" class="nav-item">Portfolio</a>
                <a href="#" class="nav-item">Settings</a>
            </nav>

            <div class="user-info">
                <div class="user-avatar" id="user-avatar">DJ</div>
                <span id="user-greeting">Welcome back!</span>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="main-container">
        <!-- üî• REFERRAL BANNER - –ì–õ–ê–í–ù–ê–Ø –§–ò–ß–ê! -->
        <div class="referral-banner" onclick="copyReferralLink()" title="Click to copy referral link">
            <div class="referral-content">
                <div class="referral-main">
                    <div class="referral-title">
                        üîó Your Personal Referral Link
                        <span style="font-size: 14px; background: rgba(255, 215, 0, 0.2); padding: 4px 8px; border-radius: 10px;">EARN FREE MONTHS!</span>
                    </div>
                    <div class="referral-link" id="referral-link">
                        https://profitpal.org?ref=LOADING...
                    </div>
                    <div class="copy-hint">üí° Click anywhere on this banner to copy your referral link!</div>
                </div>

                <div class="referral-stats">
                    <div class="referral-stat free-months-highlight">
                        <span class="stat-number-large" id="free-months-count">0</span>
                        <span class="stat-label-small">FREE MONTHS</span>
                    </div>
                    <div class="referral-stat">
                        <span class="stat-number-large" id="paid-friends-count">0</span>
                        <span class="stat-label-small">FRIENDS PAID</span>
                    </div>
                    <div class="referral-stat">
                        <span class="stat-number-large" id="money-saved">$0.00</span>
                        <span class="stat-label-small">MONEY SAVED</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- üî• BOOST DEVELOPMENT BANNER -->
        <div class="boost-banner" id="boostBanner" onclick="toggleBoostOptions()">
            <div class="boost-content">
                <div class="boost-title">
                    ‚ö° BOOST DEVELOPMENT
                    <span class="boost-subtitle">Support innovation & get premium features faster</span>
                </div>
                <div class="boost-expand-hint">Click to expand options ‚Üí</div>
            </div>
        </div>

        <!-- Expanded Donation Options -->
        <div class="boost-options" id="boostOptions" style="display: none;">
            <div class="donation-grid">
                <button class="donation-btn" onclick="selectDonation(3, 'coffee')">
                    ‚òï Developer's Coffee<br><span class="price">$3</span>
                </button>
                <button class="donation-btn" onclick="selectDonation(5, 'milk')">
                    ü•õ Coffee with Milk<br><span class="price">$5</span>
                </button>
                <button class="donation-btn" onclick="selectDonation(10, 'features')">
                    üöÄ New Features<br><span class="price">$10</span>
                </button>
                <div class="custom-donation">
                    üíù Custom Amount: <input type="number" id="customAmount" placeholder="0" min="1" max="1000" step="1" onchange="selectCustomDonation()">
                    <span class="currency">$</span>
                </div>
            </div>

            <div class="donation-agreement">
                <input type="checkbox" id="donationConsent" onchange="toggleSubmitButton()">
                <label for="donationConsent">I authorize this transaction</label>
            </div>

            <button class="donation-submit" id="submitDonation" disabled onclick="processDonation()">
                BOOST NOW
            </button>
        </div>
        <!-- üî• PRO SUBSCRIPTION BANNER -->
        <div class="pro-banner" id="proBanner" onclick="toggleProOptions()" style="display: none;">
            <div class="boost-content">
                <div class="boost-title">
                    üöÄ PRO SUBSCRIPTION
                    <span class="boost-subtitle">Upgrade to advanced options trading & analytics</span>
                </div>
                <div class="boost-expand-hint">Click to expand upgrade options ‚Üí</div>
            </div>
        </div>

        <!-- PRO Upgrade Options -->
        <div class="pro-options" id="proOptions" style="display: none;">
            <div style="background: linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(50, 205, 50, 0.05)); border-radius: 15px; padding: 25px; margin-bottom: 20px; border: 2px solid rgba(255, 107, 53, 0.3);">
                <h3 style="color: #ff6b35; margin-bottom: 15px;">üöÄ PRO Package Features ($49.99/month)</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                    <div style="color: #ffffff;">‚úÖ Real-time Options Analysis</div>
                    <div style="color: #ffffff;">üìä Live Greeks Dashboard</div>
                    <div style="color: #ffffff;">üéØ Options Strategies Simulator</div>
                    <div style="color: #ffffff;">‚ö° Volatility Spike Alerts</div>
                    <div style="color: #ffffff;">üìà Paper Trading Simulation</div>
                    <div style="color: #ffffff;">üî• Unusual Options Activity</div>
                </div>
            </div>

            <div id="prorationInfo" style="background: rgba(255, 215, 0, 0.1); border: 2px solid #ffd700; border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                <h4 style="color: #ffd700; margin-bottom: 10px;">üí∞ Proration Calculation</h4>
                <div style="color: #ffffff; font-size: 14px;" id="prorationDetails">
                    <!-- Proration details will be calculated here -->
                </div>
            </div>

            <div class="donation-agreement">
                <input type="checkbox" id="proConsent" onchange="toggleProSubmitButton()">
                <label for="proConsent">I authorize payment processing and subscription upgrade</label>
            </div>

            <button class="donation-submit" id="submitProUpgrade" disabled onclick="processProUpgrade()" style="background: linear-gradient(135deg, #ff6b35, #e74c3c);">
                UPGRADE TO PRO ($49.99/month)
            </button>
        </div>

        <!-- üî• DOWNGRADE BANNER -->
        <div class="downgrade-banner" id="downgradeBanner" onclick="toggleDowngradeOptions()" style="display: none;">
            <div class="boost-content">
                <div class="boost-title">
                    ‚¨áÔ∏è RETURN TO STANDARD
                    <span class="boost-subtitle">Downgrade from PRO to Standard subscription</span>
                </div>
                <div class="boost-expand-hint">Click to expand downgrade options ‚Üí</div>
            </div>
        </div>

        <!-- Downgrade Options -->
        <div class="downgrade-options" id="downgradeOptions" style="display: none;">
            <div style="background: linear-gradient(135deg, rgba(135, 206, 235, 0.1), rgba(95, 158, 160, 0.05)); border-radius: 15px; padding: 25px; margin-bottom: 20px; border: 2px solid rgba(135, 206, 235, 0.3);">
                <h3 style="color: #87ceeb; margin-bottom: 15px;">‚¨áÔ∏è Standard Subscription ($14.99/month)</h3>
                <div style="color: #ffffff; margin-bottom: 20px;">
                    <div>‚úÖ Real-time Market Data</div>
                    <div>‚úÖ Server Maintenance</div>
                    <div>‚úÖ Basic Stock Analysis</div>
                    <div>‚ùå Options Trading Features</div>
                    <div>‚ùå Advanced Analytics</div>
                </div>
            </div>

            <div id="downgradeProrationInfo" style="background: rgba(135, 206, 235, 0.1); border: 2px solid #87ceeb; border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                <h4 style="color: #87ceeb; margin-bottom: 10px;">üí∞ Refund Calculation</h4>
                <div style="color: #ffffff; font-size: 14px;" id="downgradeProrationDetails">
                    <!-- Downgrade proration details will be calculated here -->
                </div>
            </div>

            <div class="donation-agreement">
                <input type="checkbox" id="downgradeConsent" onchange="toggleDowngradeSubmitButton()">
                <label for="downgradeConsent">I authorize subscription downgrade and refund processing</label>
            </div>

            <button class="donation-submit" id="submitDowngrade" disabled onclick="processDowngrade()" style="background: linear-gradient(135deg, #87ceeb, #5f9ea0);">
                DOWNGRADE TO STANDARD ($14.99/month)
            </button>
        </div>

        <!-- Welcome Section -->
        <section class="welcome-section">
            <div class="welcome-content">
                <h1 class="welcome-title" id="welcome-title">Welcome back, Investor! üíé</h1>
                <p class="welcome-subtitle">Your AI-powered stock analysis dashboard is ready. Let's find your next winning investment!</p>

                <div class="quick-stats">
                    <div class="stat-item">
                        <span class="stat-number">47</span>
                        <span class="stat-label">Stocks Analyzed</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">12</span>
                        <span class="stat-label">Diamonds Found</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">+23.5%</span>
                        <span class="stat-label">Avg Returns</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">$125K</span>
                        <span class="stat-label">Portfolio Value</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Dashboard Grid -->
        <div class="dashboard-grid">
            <!-- Quick Analysis -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3 class="card-title">Quick Stock Analysis</h3>
                    <div class="card-icon">üöÄ</div>
                </div>

                <div class="analysis-input">
                    <input type="text" class="ticker-input" placeholder="Enter ticker (e.g., AAPL)" id="quickTicker">
                    <button class="analyze-btn" onclick="quickAnalysis()">Analyze</button>
                </div>

                <div id="quickResults" style="display: none;">
                    <div style="padding: 20px; background: rgba(50, 205, 50, 0.1); border-radius: 10px; border-left: 4px solid #32cd32;">
                        <h4 style="color: #32cd32; margin-bottom: 10px;">üíé AAPL Analysis Complete!</h4>
                        <p style="color: #ecf0f1; margin-bottom: 5px;">Current Price: $175.43</p>
                        <p style="color: #ecf0f1; margin-bottom: 5px;">Intrinsic Value: $198.20</p>
                        <p style="color: #32cd32; font-weight: 600;">Verdict: UNDERVALUED (+13%)</p>
                    </div>
                </div>

                <div class="action-buttons">
                    <a href="javascript:goToFullAnalysis()" class="action-btn">Full Analysis</a>
                    <a href="#" class="action-btn primary">Add to Portfolio</a>
                </div>
            </div>

            <!-- Portfolio Overview -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3 class="card-title">Portfolio Overview</h3>
                    <div class="card-icon">üìà</div>
                </div>

                <table class="portfolio-table">
                    <thead>
                        <tr>
                            <th>Stock</th>
                            <th>Value</th>
                            <th>Change</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>AAPL</td>
                            <td>$35,240</td>
                            <td class="positive">+2.3%</td>
                        </tr>
                        <tr>
                            <td>MSFT</td>
                            <td>$28,900</td>
                            <td class="positive">+1.8%</td>
                        </tr>
                        <tr>
                            <td>GOOGL</td>
                            <td>$22,150</td>
                            <td class="negative">-0.5%</td>
                        </tr>
                        <tr>
                            <td>NVDA</td>
                            <td>$18,750</td>
                            <td class="positive">+4.2%</td>
                        </tr>
                    </tbody>
                </table>

                <div class="action-buttons">
                    <a href="#" class="action-btn">View All Holdings</a>
                    <a href="#" class="action-btn">Rebalance</a>
                </div>
            </div>
        </div>

        <!-- Today's Recommendations -->
        <div class="dashboard-card">
            <div class="card-header">
                <h3 class="card-title">Today's AI Recommendations</h3>
                <div class="card-icon">‚≠ê</div>
            </div>

            <div class="recommendation-item">
                <div class="recommendation-content">
                    <h4>Tesla (TSLA) - Strong Buy Signal</h4>
                    <p>P/E ratio improved, debt levels decreased, intrinsic value indicates 18% upside potential</p>
                </div>
                <div class="recommendation-badge">BUY</div>
            </div>

            <div class="recommendation-item">
                <div class="recommendation-content">
                    <h4>Netflix (NFLX) - Potential Diamond</h4>
                    <p>Undervalued by 22% based on DCF analysis, strong fundamentals, low debt ratio</p>
                </div>
                <div class="recommendation-badge">DIAMOND</div>
            </div>

            <div class="recommendation-item">
                <div class="recommendation-content">
                    <h4>Meta (META) - Monitor Closely</h4>
                    <p>Mixed signals: good valuation but high P/E ratio, requires deeper analysis</p>
                </div>
                <div class="recommendation-badge">WATCH</div>
            </div>

            <div class="action-buttons">
                <a href="#" class="action-btn primary">Get Full Report</a>
                <a href="#" class="action-btn">Customize Alerts</a>
            </div>
        </div>

        <!-- üî• REFERRAL FRIENDS SECTION -->
        <div class="referral-friends" id="referral-friends-section" style="display: none;">
            <div class="friends-header">
                <h3 class="card-title">üéâ Your Successful Referrals</h3>
                <div class="next-billing-info" id="next-billing-info">Next billing: FREE!</div>
            </div>

            <div id="friends-list">
                <!-- Friends will be loaded dynamically -->
            </div>

            <div class="progress-section">
                <h4 style="color: #ffd700; margin-bottom: 10px;">üéØ Referral Goal Progress</h4>
                <div class="progress-bar-container">
                    <div class="progress-bar" id="progress-bar" style="width: 0%;"></div>
                </div>
                <p style="color: #87ceeb; margin: 0;" id="progress-text">
                    0 of 12 friends joined ‚Ä¢ 12 more for a FREE YEAR! üéÅ
                </p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer style="text-align: center; padding: 30px 20px; margin-top: 50px; border-top: 1px solid rgba(34, 139, 34, 0.2); color: #95a5a6; font-size: 14px;">
        ¬© 2025 ProfitPal. A product of Denava LLC. All rights reserved.
    </footer>

    <script>
        // üî• –ü–†–ê–í–ò–õ–¨–ù–ê–Ø –õ–û–ì–ò–ö–ê - –î–ê–ù–ù–´–ï –ò–ó API
        let userData = {
            fullName: "Loading...",
            email: "loading@example.com",
            referralLink: "https://profitpal.org?ref=LOADING...",
            freeMonthsBalance: 0,        // –û—Å—Ç–∞—Ç–æ–∫ free months
            totalPaidReferrals: 0,       // –ö–æ–ª-–≤–æ –¥—Ä—É–∑–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ó–ê–ü–õ–ê–¢–ò–õ–ò $29.99
            totalEarnedMonths: 0,        // –í—Å–µ–≥–æ earned months –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è
            recentReferrals: []          // –°–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π —Å –¥–∞—Ç–∞–º–∏
        };

        // üî• DONATION –°–ò–°–¢–ï–ú–ê
        let selectedDonationAmount = 0;
        let selectedDonationType = '';
        // üî• PRO SUBSCRIPTION LOGIC
        function toggleProOptions() {
            const options = document.getElementById('proOptions');
            const banner = document.getElementById('proBanner');

            if (options.style.display === 'none') {
                options.style.display = 'block';
                banner.querySelector('.boost-expand-hint').textContent = 'Click to collapse ‚Üë';
                calculateProration('upgrade');
            } else {
                options.style.display = 'none';
                banner.querySelector('.boost-expand-hint').textContent = 'Click to expand upgrade options ‚Üí';
            }
        }

        // üöÄ –§–£–ù–ö–¶–ò–Ø –ü–ï–†–ï–•–û–î–ê –ù–ê –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó –° –¢–ò–ö–ï–†–û–ú  
        function goToFullAnalysis() {
            const ticker = document.getElementById('quickTicker').value.toUpperCase().trim();
            if (!ticker) {
                alert('Please enter a ticker first');
                return;
            }
            console.log('üéØ Going to full analysis with ticker:', ticker);
            window.location.href = `/stock-analysis?ticker=${ticker}`;
        }


        function toggleDowngradeOptions() {
            const options = document.getElementById('downgradeOptions');
            const banner = document.getElementById('downgradeBanner');

            if (options.style.display === 'none') {
                options.style.display = 'block';
                banner.querySelector('.boost-expand-hint').textContent = 'Click to collapse ‚Üë';
                calculateProration('downgrade');
            } else {
                options.style.display = 'none';
                banner.querySelector('.boost-expand-hint').textContent = 'Click to expand downgrade options ‚Üí';
            }
        }

        function calculateProration(type) {
            const today = new Date();
            const year = today.getFullYear();
            const month = today.getMonth() + 1;
            const day = today.getDate();

            // Get days in current month using calendar
            const daysInMonth = new Date(year, month, 0).getDate();
            const daysUsed = day - 1;
            const daysRemaining = daysInMonth - daysUsed;

            if (type === 'upgrade') {
                // Early Bird $9.99 ‚Üí PRO $49.99
                const currentPrice = 9.99;
                const newPrice = 49.99;
                const dailyRateCurrent = currentPrice / daysInMonth;
                const dailyRateNew = newPrice / daysInMonth;

                const refund = dailyRateCurrent * daysRemaining;
                const newCharge = dailyRateNew * daysRemaining;
                const totalCharge = newCharge - refund;

                document.getElementById('prorationDetails').innerHTML = `
                    <div>üìÖ Current month: ${daysUsed} days used, ${daysRemaining} days remaining (${daysInMonth} total)</div>
                    <div>üí∏ Refund for unused Early Bird: $${refund.toFixed(2)}</div>
                    <div>üí≥ Charge for PRO remainder: $${newCharge.toFixed(2)}</div>
                    <div style="font-weight: bold; color: #ffd700; margin-top: 10px;">
                        üí∞ Total charge today: $${totalCharge.toFixed(2)}
                    </div>
                `;
            } else {
                // PRO $49.99 ‚Üí Standard $14.99
                const currentPrice = 49.99;
                const newPrice = 14.99;
                const dailyRateCurrent = currentPrice / daysInMonth;
                const dailyRateNew = newPrice / daysInMonth;

                const refund = dailyRateCurrent * daysRemaining;
                const newCharge = dailyRateNew * daysRemaining;
                const totalRefund = refund - newCharge;

                document.getElementById('downgradeProrationDetails').innerHTML = `
                    <div>üìÖ Current month: ${daysUsed} days used, ${daysRemaining} days remaining (${daysInMonth} total)</div>
                    <div>üí∏ Refund for unused PRO: $${refund.toFixed(2)}</div>
                    <div>üí≥ Charge for Standard remainder: $${newCharge.toFixed(2)}</div>
                    <div style="font-weight: bold; color: #87ceeb; margin-top: 10px;">
                        üí∞ Total refund: $${totalRefund.toFixed(2)}
                    </div>
                `;
            }
        }

        function toggleProSubmitButton() {
            const consent = document.getElementById('proConsent').checked;
            const submitBtn = document.getElementById('submitProUpgrade');
            submitBtn.disabled = !consent;
        }

        function toggleDowngradeSubmitButton() {
            const consent = document.getElementById('downgradeConsent').checked;
            const submitBtn = document.getElementById('submitDowngrade');
            submitBtn.disabled = !consent;
        }

        async function processProUpgrade() {
            alert('üöÄ PRO Package upgrade will be available soon! Options trading features are in development.');
            // TODO: Implement actual upgrade logic when options API is ready
        }

        async function processDowngrade() {
            alert('‚¨áÔ∏è Downgrade functionality will be available when PRO package launches!');
            // TODO: Implement actual downgrade logic
        }

        // Show appropriate banner based on user's current plan
        function updateSubscriptionBanners() {
            const userPlan = getCurrentUserPlan(); // This would come from API

            if (userPlan === 'early_bird' || userPlan === 'standard') {
                document.getElementById('proBanner').style.display = 'block';
                document.getElementById('downgradeBanner').style.display = 'none';
            } else if (userPlan === 'pro') {
                document.getElementById('proBanner').style.display = 'none';
                document.getElementById('downgradeBanner').style.display = 'block';
            }
        }

        function getCurrentUserPlan() {
            // TODO: Get from API, for now return demo
            return 'early_bird'; // or 'standard', 'pro'
        }

        function toggleBoostOptions() {
            const options = document.getElementById('boostOptions');
            const banner = document.getElementById('boostBanner');

            if (options.style.display === 'none') {
                options.style.display = 'block';
                banner.querySelector('.boost-expand-hint').textContent = 'Click to collapse ‚Üë';
            } else {
                options.style.display = 'none';
                banner.querySelector('.boost-expand-hint').textContent = 'Click to expand options ‚Üí';
            }
        }

        function selectDonation(amount, type) {
            selectedDonationAmount = amount;
            selectedDonationType = type;

            // Reset custom amount if preset selected
            document.getElementById('customAmount').value = '';

            // Highlight selected button
            document.querySelectorAll('.donation-btn').forEach(btn => {
                btn.style.background = 'linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(255, 193, 7, 0.05))';
                btn.style.borderColor = 'rgba(255, 107, 53, 0.3)';
            });

            event.target.style.background = 'linear-gradient(135deg, rgba(255, 107, 53, 0.3), rgba(255, 193, 7, 0.2))';
            event.target.style.borderColor = '#ff6b35';

            toggleSubmitButton();
        }

        function selectCustomDonation() {
            const customAmount = parseInt(document.getElementById('customAmount').value);
            if (customAmount && customAmount > 0) {
                selectedDonationAmount = customAmount;
                selectedDonationType = 'custom';

                // Reset preset buttons
                document.querySelectorAll('.donation-btn').forEach(btn => {
                    btn.style.background = 'linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(255, 193, 7, 0.05))';
                    btn.style.borderColor = 'rgba(255, 107, 53, 0.3)';
                });
            }

            toggleSubmitButton();
        }

        function toggleSubmitButton() {
            const consent = document.getElementById('donationConsent').checked;
            const hasAmount = selectedDonationAmount > 0;
            const submitBtn = document.getElementById('submitDonation');

            submitBtn.disabled = !(consent && hasAmount);
        }

        async function processDonation() {
          if (selectedDonationAmount <= 0) {
            alert('Please select a donation amount');
            return;
          }

          // –≥–∞–ª–æ—á–∫–∞ "I authorize this transaction"
          const authorized = document.getElementById('authorizeDonation')?.checked;
          if (!authorized) {
            alert('Please check "I authorize this transaction"');
            return;
          }

          const submitBtn = document.getElementById('submitDonation');
          submitBtn.textContent = 'Processing...';
          submitBtn.disabled = true;

          try {
            // –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ; email –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º
            await apiPost('/api/process-donation', {
              amount: selectedDonationAmount,
              type: selectedDonationType,
              authorized: authorized
            });

            // —É—Å–ø–µ—Ö ‚Äî –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–≤–æ—é –ª–æ–≥–∏–∫—É
            showDonationSuccess();
            toggleBoostOptions();    // Close options
            resetDonationForm();

          } catch (error) {
            console.error('Donation error:', error);
            alert('Donation failed. Please try again.');
          } finally {
            submitBtn.textContent = 'BOOST NOW';
            submitBtn.disabled = false;
          }
        }


        function showDonationSuccess() {
            const successDiv = document.createElement('div');
            successDiv.className = 'copy-success';

            let message = 'üíé Thank you for supporting ProfitPal! ';
            if (selectedDonationType === 'coffee') {
                message += 'I love black coffee, thank you dear person! ‚òï';
            } else if (selectedDonationType === 'milk') {
                message += 'Oh! Black coffee with milk! You amazing human! ü•õ';
            } else if (selectedDonationType === 'features') {
                message += 'Features are coming, this will be awesome! üöÄ';
            } else {
                message += 'Huge thanks for recognizing my work! üíù';
            }

            successDiv.textContent = message;
            document.body.appendChild(successDiv);

            setTimeout(() => {
                document.body.removeChild(successDiv);
            }, 4000);
        }

        function resetDonationForm() {
            selectedDonationAmount = 0;
            selectedDonationType = '';
            document.getElementById('customAmount').value = '';
            document.getElementById('donationConsent').checked = false;

            // Reset button styles
            document.querySelectorAll('.donation-btn').forEach(btn => {
                btn.style.background = 'linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(255, 193, 7, 0.05))';
                btn.style.borderColor = 'rgba(255, 107, 53, 0.3)';
            });

            const submitBtn = document.getElementById('submitDonation');
            submitBtn.textContent = 'BOOST NOW';
            submitBtn.disabled = true;
        }

        // üî• –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–• –ò–ó API
        async function loadUserData() {
            try {
                // –ü–æ–ª—É—á–∞–µ–º email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ URL –∏–ª–∏ localStorage
                const userEmail = getUserEmail();

                if (!userEmail) {
                    console.log('User email not found, using demo data');
                    showDemoData();
                    return;
                }

                console.log('Loading referral data for:', userEmail);

                // API –∑–∞–ø—Ä–æ—Å –∑–∞ referral —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
                const response = await fetch('/api/referral-stats/me', { credentials: 'include' });


                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –æ—Ç–≤–µ—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ JSON
                const contentType = response.headers.get('content-type');
                if (!contentType || !contentType.includes('application/json')) {
                    console.log('API endpoint not available, using demo data');
                    showDemoData();
                    return;
                }

                const data = await response.json();

                if (data.error) {
                    console.log('No referral data found:', data.error);
                    showDemoData();
                    return;
                }

                // –û–±–Ω–æ–≤–ª—è–µ–º userData –∏–∑ API
                if (data.referral_info) {
                    userData.referralLink = data.referral_info.referral_link;
                    userData.freeMonthsBalance = data.referral_info.free_months_balance;
                    userData.totalPaidReferrals = data.referral_info.total_referrals;
                    userData.totalEarnedMonths = data.referral_info.total_earned_months;
                }

                if (data.recent_referrals) {
                    userData.recentReferrals = data.recent_referrals;
                }

                console.log('‚úÖ Referral data loaded successfully');
                updateUI();

            } catch (error) {
                console.log('API –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º demo –¥–∞–Ω–Ω—ã–µ:', error);
                showDemoData();
            }
        }

        // üîß –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø showDemoData() - ADMIN –ò–õ–ò DEMO –î–ê–ù–ù–´–ï
        function showDemoData() {
            const userEmail = getUserEmail();
            const userRole = localStorage.getItem('pp_user_role') || 'client';

            // üëë –ü–†–û–í–ï–†–Ø–ï–ú –ï–°–õ–ò –≠–¢–û ADMIN
            const adminEmail = 'denava.business@gmail.com'; // –í–∞—à admin email
            const isAdmin = (userEmail.toLowerCase() === adminEmail.toLowerCase()) || (userRole === 'admin');

            if (isAdmin) {
                // üëë ADMIN –î–ê–ù–ù–´–ï
                userData = {
                    fullName: "System Administrator",
                    email: adminEmail,
                    referralLink: "https://profitpal.org?ref=ADMIN-SYSTEM-ACCESS",
                    freeMonthsBalance: 999,        // Admin –∏–º–µ–µ—Ç –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø
                    totalPaidReferrals: 0,         // Admin –Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ referral –ø—Ä–æ–≥—Ä–∞–º–º–µ
                    totalEarnedMonths: 0,          // Admin –Ω–µ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –º–µ—Å—è—Ü—ã
                    recentReferrals: []            // Admin –Ω–µ –∏–º–µ–µ—Ç referrals
                };

                console.log('üëë Admin demo data loaded for:', adminEmail);
            } else {
                // üë§ –û–ë–´–ß–ù–´–ï DEMO –î–ê–ù–ù–´–ï –î–õ–Ø –ö–õ–ò–ï–ù–¢–û–í
                userData = {
                    fullName: "DJ Investor",
                    email: "dj@profitpal.org", 
                    referralLink: "https://profitpal.org?ref=ABCDE12345fghij",
                    freeMonthsBalance: 3,
                    totalPaidReferrals: 3,
                    totalEarnedMonths: 3,
                    recentReferrals: [
                        { new_user_email: "alex.smith@gmail.com", used_at: "2025-01-03" },
                        { new_user_email: "sarah.jones@yahoo.com", used_at: "2025-01-01" },
                        { new_user_email: "mike.wilson@gmail.com", used_at: "2024-12-28" }
                    ]
                };

                console.log('üë§ Client demo data loaded for:', userEmail);
            }

            // üé® –û–±–Ω–æ–≤–ª—è–µ–º UI —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
            updateUI();
        }

        function updateUI() {
            // üî• –ü–†–ê–í–ò–õ–¨–ù–´–ï –†–ê–°–ß–ï–¢–´
            const freeMonths = userData.freeMonthsBalance;
            const paidFriends = userData.totalPaidReferrals;
            const moneySaved = userData.totalEarnedMonths * 9.99; // NEW PRICING

            // üëë –ü–†–û–í–ï–†–ö–ê ADMIN –†–û–õ–ò –° –ö–û–†–û–õ–ï–í–°–ö–ò–ú –ò–ù–¢–ï–†–§–ï–ô–°–û–ú
            const userRole = localStorage.getItem('pp_user_role') || 'client';
            const userEmail = localStorage.getItem('pp_email') || '';
            const isAdmin = (userRole === 'admin') || (userEmail.toLowerCase() === 'denava.business@gmail.com');

            if (isAdmin) {
                // üëë –ö–û–†–û–õ–ï–í–°–ö–ò–ô ADMIN –ò–ù–¢–ï–†–§–ï–ô–°
                const userAvatar = document.getElementById('user-avatar');
                const userGreeting = document.getElementById('user-greeting');

                // üíé –ó–û–õ–û–¢–ê–Ø –ö–û–†–û–ù–ê –í–ú–ï–°–¢–û –ò–ù–ò–¶–ò–ê–õ–û–í
                userAvatar.innerHTML = 'üëë';
                userAvatar.style.background = 'linear-gradient(135deg, #ffd700, #ff6b35)';
                userAvatar.style.border = '3px solid #ffd700';
                userAvatar.style.boxShadow = '0 0 20px rgba(255, 215, 0, 0.6)';

                // üî• –ö–û–†–û–õ–ï–í–°–ö–û–ï –ü–†–ò–í–ï–¢–°–¢–í–ò–ï
                userGreeting.innerHTML = 'üëë <span style="color: #ffd700; font-size: 18px; font-weight: 800;">ADMIN MODE</span>';

                console.log('üëë Royal Admin interface activated');
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—á–µ—Ç—á–∏–∫–∏
            document.getElementById('referral-link').textContent = userData.referralLink;
            document.getElementById('free-months-count').textContent = freeMonths;
            document.getElementById('paid-friends-count').textContent = paidFriends;
            document.getElementById('money-saved').textContent = `$${moneySaved.toFixed(2)}`;

            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ (–¢–û–õ–¨–ö–û –î–õ–Ø –ù–ï-–ê–î–ú–ò–ù–û–í)
            if (!isAdmin) {
                const initials = userData.fullName.split(' ').map(n => n[0]).join('');
                document.getElementById('user-avatar').textContent = initials;
                document.getElementById('user-greeting').textContent = `Welcome back, ${userData.fullName.split(' ')[0]}!`;
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
            updateGreeting(isAdmin ? 'Admin' : userData.fullName.split(' ')[0]);

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º friends section —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å referrals
            if (paidFriends > 0) {
                document.getElementById('referral-friends-section').style.display = 'block';
                updateFriendsList();
                updateProgress();
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–ª–µ–¥—É—é—â–µ–º –±–∏–ª–ª–∏–Ω–≥–µ
            updateNextBilling();
        }

        function updateFriendsList() {
            const friendsList = document.getElementById('friends-list');
            friendsList.innerHTML = '';

            userData.recentReferrals.forEach(referral => {
                const friendDiv = document.createElement('div');
                friendDiv.className = 'friend-item';

                const date = new Date(referral.used_at);
                const timeAgo = getTimeAgo(date);

                friendDiv.innerHTML = `
                    <div>
                        <div class="friend-email">${referral.new_user_email}</div>
                        <div class="friend-date">Joined ${timeAgo}</div>
                    </div>
                    <div class="friend-reward">+1 FREE MONTH</div>
                `;

                friendsList.appendChild(friendDiv);
            });
        }

        function updateProgress() {
            const current = userData.totalPaidReferrals;
            const target = 12; // 12 –¥—Ä—É–∑–µ–π –¥–ª—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ –≥–æ–¥–∞
            const percentage = Math.min((current / target) * 100, 100);

            document.getElementById('progress-bar').style.width = `${percentage}%`;

            const remaining = Math.max(target - current, 0);
            document.getElementById('progress-text').textContent = 
                `${current} of ${target} friends joined ‚Ä¢ ${remaining} more for a FREE YEAR! üéÅ`;
        }

        function updateNextBilling() {
            const freeMonths = userData.freeMonthsBalance;
            const billingInfo = document.getElementById('next-billing-info');

            if (freeMonths > 0) {
                billingInfo.textContent = `Next ${freeMonths} billing${freeMonths > 1 ? 's' : ''}: FREE!`;
                billingInfo.style.background = 'rgba(50, 205, 50, 0.1)';
                billingInfo.style.color = '#32cd32';
            } else {
                billingInfo.textContent = 'Next billing: $9.99 on 1st'; // NEW PRICING
                billingInfo.style.background = 'rgba(255, 107, 53, 0.1)';
                billingInfo.style.color = '#ff6b35';
            }
        }

        function getTimeAgo(date) {
            const now = new Date();
            const diffTime = Math.abs(now - date);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

            if (diffDays === 1) return '1 day ago';
            if (diffDays < 7) return `${diffDays} days ago`;
            if (diffDays < 30) {
                const weeks = Math.floor(diffDays / 7);
                return weeks === 1 ? '1 week ago' : `${weeks} weeks ago`;
            }
            const months = Math.floor(diffDays / 30);
            return months === 1 ? '1 month ago' : `${months} months ago`;
        }

            // üîß –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø getUserEmail() - –ß–ò–¢–ê–ï–¢ –ò–ó ADMIN –°–ï–°–°–ò–ò
        function getUserEmail() {
            // üéØ –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º localStorage –∏–∑ admin –ª–æ–≥–∏–Ω–∞
            const sessionEmail = localStorage.getItem('pp_email');
            if (sessionEmail) {
                console.log('üìß Found admin email in session:', sessionEmail);
                return sessionEmail;
            }

            // üîç Fallback: –ø—Ä–æ–≤–µ—Ä—è–µ–º URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
            const urlParams = new URLSearchParams(window.location.search);
            const urlEmail = urlParams.get('email');
            if (urlEmail) {
                console.log('üìß Found email in URL:', urlEmail);
                return urlEmail;
            }

            // üö® –ü–æ—Å–ª–µ–¥–Ω–∏–π fallback - demo –¥–∞–Ω–Ω—ã–µ
            console.log('‚ö†Ô∏è No admin session found, using demo data');
            return 'dj@profitpal.org';
        }

        // üî• –ö–û–ü–ò–†–û–í–ê–ù–ò–ï REFERRAL –°–°–´–õ–ö–ò
        async function copyReferralLink() {
            try {
                const referralLink = userData.referralLink;
                await navigator.clipboard.writeText(referralLink);

                showCopySuccess();

                // –ê–Ω–∏–º–∞—Ü–∏—è banner
                const banner = document.querySelector('.referral-banner');
                banner.style.transform = 'translateY(-3px) scale(1.02)';
                banner.style.borderColor = '#32cd32';

                setTimeout(() => {
                    banner.style.transform = '';
                    banner.style.borderColor = '';
                }, 500);

            } catch (err) {
                console.error('Failed to copy: ', err);
                // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
                const textArea = document.createElement('textarea');
                textArea.value = userData.referralLink;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showCopySuccess();
            }
        }

        function showCopySuccess() {
            const successDiv = document.createElement('div');
            successDiv.className = 'copy-success';
            successDiv.innerHTML = 'üéâ Referral link copied! Share with friends! üíé';
            document.body.appendChild(successDiv);

            setTimeout(() => {
                document.body.removeChild(successDiv);
            }, 2000);
        }

        // Quick Analysis Function
        function quickAnalysis() {
            const ticker = document.getElementById('quickTicker').value.toUpperCase();
            const resultsDiv = document.getElementById('quickResults');

            if (!ticker) {
                alert('Please enter a stock ticker symbol');
                return;
            }

            // Show loading
            const btn = document.querySelector('.analyze-btn');
            btn.textContent = 'Analyzing...';
            btn.disabled = true;

            // Simulate API call
            setTimeout(() => {
                resultsDiv.style.display = 'block';
                btn.textContent = 'Analyze';
                btn.disabled = false;

                // Update results with ticker
                const resultContent = resultsDiv.querySelector('h4');
                resultContent.textContent = `üíé ${ticker} Analysis Complete!`;

                resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 2000);
        }

        // Keyboard shortcut for quick analysis
        document.getElementById('quickTicker').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                quickAnalysis();
            }
        });

        // Update time-based greetings
        function updateGreeting(firstName = 'Investor') {
            const hour = new Date().getHours();
            const welcomeTitle = document.getElementById('welcome-title');
            const isAdmin = firstName === 'Admin';

            let timeGreeting;
            if (hour < 12) {
                timeGreeting = 'Good morning';
            } else if (hour < 18) {
                timeGreeting = 'Good afternoon';
            } else {
                timeGreeting = 'Good evening';
            }

            if (isAdmin) {
                // üëë –ö–û–†–û–õ–ï–í–°–ö–û–ï –ü–†–ò–í–ï–¢–°–¢–í–ò–ï –î–õ–Ø –ê–î–ú–ò–ù–ê
                welcomeTitle.innerHTML = `${timeGreeting}, <span style="color: #ffd700;">Admin</span>! üëëüíé`;
            } else {
                // üë§ –û–ë–´–ß–ù–û–ï –ü–†–ò–í–ï–¢–°–¢–í–ò–ï –î–õ–Ø –ö–õ–ò–ï–ù–¢–û–í
                welcomeTitle.textContent = `${timeGreeting}, ${firstName}! üíé`;
            }
        }

        // üî• –ê–ù–ò–ú–ê–¶–ò–Ø FREE MONTHS COUNTER
        function animateFreeMonths() {
            const counter = document.getElementById('free-months-count');

            // –ü—É–ª—å—Å–∏—Ä—É—é—â–∏–π —ç—Ñ—Ñ–µ–∫—Ç –∫–∞–∂–¥—ã–µ 15 —Å–µ–∫—É–Ω–¥
            setInterval(() => {
                if (parseInt(counter.textContent) > 0) {
                    counter.style.transform = 'scale(1.2)';
                    counter.style.color = '#ffd700';
                    setTimeout(() => {
                        counter.style.transform = 'scale(1)';
                        counter.style.color = 'white';
                    }, 300);
                }
            }, 15000);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // –°–Ω–∞—á–∞–ª–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º demo –¥–∞–Ω–Ω—ã–µ, –ø–æ—Ç–æ–º –∑–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—Å—Ç–æ—è—â–∏–µ
            showDemoData();
            loadUserData();
            animateFreeMonths();
            updateSubscriptionBanners();

            // Add smooth transitions for cards
            const cards = document.querySelectorAll('.dashboard-card, .referral-banner, .boost-banner');
            cards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';

                setTimeout(() => {
                    card.style.transition = 'all 0.6s ease';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 200);
            });
        });

        // Auto-refresh stats every 5 minutes
        setInterval(() => {
            loadUserData();
        }, 300000); // 5 minutes

    </script>
</body>
</html>